<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Voucher Uber</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
            --uber-black: #1f2937;
            --uber-white: #ffffff;
            --bg-light: #f3f4f6;
        }

        body { font-family: 'Inter', sans-serif; background-color: var(--bg-light); margin: 0; padding: 0; }

        .header {
            background: linear-gradient(rgba(106, 17, 203, 0.6), rgba(37, 117, 252, 0.6)), 
                        url('https://wecanbr.com.br/img/quem-somos/main.jpg');
            background-size: cover; background-position: center; height: 200px;
            display: flex; justify-content: center; align-items: center; color: white;
        }

        .header h1 { font-family: 'Montserrat', sans-serif; font-size: 28px; text-transform: uppercase; letter-spacing: 2px; }

        .container {
            max-width: 700px; margin: -40px auto 40px; background: var(--uber-white);
            padding: 30px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        h2 { font-family: 'Montserrat', sans-serif; color: var(--uber-black); font-size: 22px; margin-bottom: 25px; border-bottom: 3px solid #6a11cb; display: inline-block; padding-bottom: 5px; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }
        label { display: block; font-size: 11px; font-weight: 700; color: #666; margin-bottom: 5px; text-transform: uppercase; }
        input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
        
        button {
            grid-column: span 2; background-color: var(--uber-black); color: white; padding: 15px;
            border: none; border-radius: 6px; font-size: 14px; font-weight: 700; text-transform: uppercase;
            cursor: pointer; margin-top: 10px; transition: 0.3s;
        }

        button:hover { background-color: #000; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        #mensagem {
            grid-column: span 2; text-align: center; padding: 12px; border-radius: 6px;
            display: none; font-weight: 600; margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="header"><h1>APOIO AO ONSITE</h1></div>

<div class="container">
    <h2>Cadastro Voucher Uber</h2>
    <form id="cadastroForm">
        <div class="form-grid">
            <div class="form-group full-width">
                <label>CENTRO DE CUSTO</label>
                <input type="text" id="centroCusto" placeholder="Ex: LM Hub_SP_Jundiaí" required>
            </div>
            <div class="form-group">
                <label>MATRÍCULA</label>
                <input type="text" id="matricula" placeholder="Digite a matrícula" required>
            </div>
            <div class="form-group">
                <label>NOME COMPLETO</label>
                <input type="text" id="nomeCompleto" placeholder="Nome do colaborador" required>
            </div>
            <div class="form-group">
                <label>DATA DE ADMISSÃO</label>
                <input type="date" id="dataAdmissao" required>
            </div>
            <div class="form-group">
                <label>TELEFONE</label>
                <input type="tel" id="telefone" placeholder="(00) 00000-0000" required>
            </div>
            <div class="form-group full-width">
                <label>HORÁRIO (ENTRADA AS SAÍDA)</label>
                <input type="text" id="horario" placeholder="Ex: 01:00 AS 08:49" required>
            </div>
            <button type="submit" id="btnEnviar">CADASTRAR COLABORADOR</button>
            <div id="mensagem"></div>
        </div>
    </form>
</div>

<script>
    const form = document.getElementById('cadastroForm');
    const btn = document.getElementById('btnEnviar');
    const msg = document.getElementById('mensagem');

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        btn.disabled = true;
        btn.innerText = "PROCESSANDO...";
        msg.style.display = "none";

        const dados = {
            centroCusto: document.getElementById('centroCusto').value,
            matricula: document.getElementById('matricula').value,
            nomeCompleto: document.getElementById('nomeCompleto').value,
            dataAdmissao: document.getElementById('dataAdmissao').value,
            telefone: document.getElementById('telefone').value,
            horario: document.getElementById('horario').value
        };

        google.script.run
            .withSuccessHandler(function(resposta) {
                if (resposta === "OK") {
                    msg.innerText = "CADASTRO REALIZADO COM SUCESSO!";
                    msg.style.backgroundColor = "#dcfce7";
                    msg.style.color = "#166534";
                    msg.style.display = "block";
                    form.reset();
                } else {
                    msg.innerText = resposta;
                    msg.style.backgroundColor = "#fee2e2";
                    msg.style.color = "#991b1b";
                    msg.style.display = "block";
                }
                btn.disabled = false;
                btn.innerText = "CADASTRAR COLABORADOR";
            })
            .withFailureHandler(function(error) {
                msg.innerText = "ERRO TÉCNICO: " + error;
                msg.style.display = "block";
                btn.disabled = false;
                btn.innerText = "CADASTRAR COLABORADOR";
            })
            .salvarDados(dados); // Chama a função do Código.gs
    });
</script>
</body>
</html>
